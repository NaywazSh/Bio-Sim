<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DNA Simulation</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; color: white; font-family: sans-serif; }
        #ui-container {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            width: 300px; text-align: center; background: rgba(20, 20, 20, 0.8);
            padding: 15px; border-radius: 12px; border: 1px solid #333;
        }
        input[type=range] { width: 100%; cursor: pointer; }
    </style>
</head>
<body>

    <div id="ui-container">
        <label>Twist / Unwind DNA</label>
        <input type="range" id="twistSlider" min="0" max="10" step="0.1" value="2">
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://unpkg.com/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

    <script>
        let scene, camera, renderer, dnaGroup;
        const count = 40; // Number of base pairs
        const particles = [];

        function init() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x050505);

            camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 100);
            camera.position.set(0, 0, 30);

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            new THREE.OrbitControls(camera, renderer.domElement);

            // Lighting
            const light = new THREE.PointLight(0xffffff, 1, 100);
            light.position.set(0, 0, 10);
            scene.add(light);
            scene.add(new THREE.AmbientLight(0x404040));

            // Create DNA
            dnaGroup = new THREE.Group();
            scene.add(dnaGroup);
            createDNA(2); // Initial twist value

            animate();
        }

        function createDNA(twist) {
            // Clear existing
            while(dnaGroup.children.length > 0){ 
                dnaGroup.remove(dnaGroup.children[0]); 
            }

            const geometry = new THREE.SphereGeometry(0.5, 16, 16);
            const connectorGeo = new THREE.CylinderGeometry(0.1, 0.1, 4, 8);

            // Colors for Base Pairs (A-T, G-C)
            const red = new THREE.MeshPhongMaterial({ color: 0xff4444 });
            const blue = new THREE.MeshPhongMaterial({ color: 0x4444ff });
            const yellow = new THREE.MeshPhongMaterial({ color: 0xffff44 });
            const green = new THREE.MeshPhongMaterial({ color: 0x44ff44 });

            for (let i = -count/2; i < count/2; i++) {
                const y = i * 1.5; // Vertical spacing
                const angle = i * twist * 0.2; // Rotation per step

                const x1 = Math.cos(angle) * 4;
                const z1 = Math.sin(angle) * 4;
                const x2 = -x1;
                const z2 = -z1;

                // Sphere Strand 1
                const sphere1 = new THREE.Mesh(geometry, i % 2 === 0 ? red : yellow);
                sphere1.position.set(x1, y, z1);
                dnaGroup.add(sphere1);

                // Sphere Strand 2
                const sphere2 = new THREE.Mesh(geometry, i % 2 === 0 ? blue : green);
                sphere2.position.set(x2, y, z2);
                dnaGroup.add(sphere2);

                // Connector (Hydrogen bond)
                const connector = new THREE.Mesh(connectorGeo, new THREE.MeshPhongMaterial({color: 0xdddddd}));
                connector.position.set(0, y, 0);
                connector.rotation.y = -angle; // Rotate cylinder to match spheres
                connector.rotation.z = Math.PI / 2; // Lay flat
                dnaGroup.add(connector);
            }
        }

        // Slider Logic
        document.getElementById('twistSlider').addEventListener('input', (e) => {
            createDNA(e.target.value);
        });

        function animate() {
            requestAnimationFrame(animate);
            dnaGroup.rotation.y += 0.005; // Slow rotate whole model
            renderer.render(scene, camera);
        }

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        init();
    </script>
</body>
</html>
